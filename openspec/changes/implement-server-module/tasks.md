## 1. 项目设置和依赖管理
- [ ] 1.1 更新 go.mod 添加 Gin 框架依赖
- [ ] 1.2 创建 internal/server 目录结构
- [ ] 1.3 设置模块包文档和基础导入

## 2. 配置结构实现（TDD - 测试先行）
- [ ] 2.1 编写 Config 结构体的单元测试
  - [ ] 2.1.1 测试默认配置值
  - [ ] 2.1.2 测试配置验证（有效值）
  - [ ] 2.1.3 测试配置验证（无效值边界）
  - [ ] 2.1.4 测试配置序列化/反序列化
- [ ] 2.2 实现 Config 结构体和 DefaultConfig() 函数
- [ ] 2.3 实现 Config.Validate() 方法
- [ ] 2.4 运行配置相关测试确保通过

## 3. 接口定义和基础结构（TDD）
- [ ] 3.1 编写 Server 接口的测试用例
  - [ ] 3.1.1 测试 Start() 方法行为定义
  - [ ] 3.1.2 测试 Stop() 方法行为定义
- [ ] 3.2 编写 MetricsService 和 HealthService 接口的 mock 测试
- [ ] 3.3 定义 Server、MetricsService、HealthService 接口
- [ ] 3.4 实现 HTTPServer 结构体和构造函数
- [ ] 3.5 创建相关 mock 结构体用于测试隔离

## 4. 核心路由处理器实现（TDD）
- [ ] 4.1 编写 /health 端点的测试用例
  - [ ] 4.1.1 测试正常健康检查响应
  - [ ] 4.1.2 测试健康检查异常响应
  - [ ] 4.1.3 测试响应格式和内容
- [ ] 4.2 编写 /metrics 端点的测试用例
  - [ ] 4.2.1 测试正常指标获取响应
  - [ ] 4.2.2 测试 MetricsService 异常处理
  - [ ] 4.2.3 测试响应内容类型和格式
- [ ] 4.3 编写 404 处理器的测试用例
  - [ ] 4.3.1 测试未知路径的 404 响应
  - [ ] 4.3.2 测试错误响应格式
- [ ] 4.4 实现 healthHandler 函数
- [ ] 4.5 实现 metricsHandler 函数
- [ ] 4.6 实现 notFoundHandler 函数
- [ ] 4.7 运行路由处理器测试确保通过

## 5. 中间件实现（TDD）
- [ ] 5.1 编写请求日志中间件测试
  - [ ] 5.1.1 测试日志记录格式和内容
  - [ ] 5.1.2 测试敏感信息过滤
  - [ ] 5.1.3 测试各种 HTTP 方法和状态码
- [ ] 5.2 编写恢复中间件测试
  - [ ] 5.2.1 测试 panic 捕获和恢复
  - [ ] 5.2.2 测试错误响应格式
  - [ ] 5.2.3 测试错误日志记录
- [ ] 5.3 编写 CORS 中间件测试（可选）
  - [ ] 5.3.1 测试 CORS 头设置
  - [ ] 5.3.2 测试预检请求处理
  - [ ] 5.3.3 测试配置禁用时的行为
- [ ] 5.4 编写限流中间件测试（可选）
  - [ ] 5.4.1 测试正常请求通过
  - [ ] 5.4.2 测试超限请求拒绝
  - [ ] 5.4.3 测试 429 响应格式
- [ ] 5.5 实现 loggingMiddleware 函数
- [ ] 5.6 实现 recoveryMiddleware 函数
- [ ] 5.7 实现 corsMiddleware 函数（可选）
- [ ] 5.8 实现 rateLimitMiddleware 函数（可选）
- [ ] 5.9 运行中间件测试确保通过

## 6. 路由设置和引擎配置（TDD）
- [ ] 6.1 编写路由设置测试用例
  - [ ] 6.1.1 测试路由注册正确性
  - [ ] 6.1.2 测试中间件链顺序
  - [ ] 6.1.3 测试 pprof 路由可选性
- [ ] 6.2 实现 setupMiddleware() 方法
- [ ] 6.3 实现 setupRoutes() 方法
- [ ] 6.4 实现 setupPprofRoutes() 方法（可选）
- [ ] 6.5 运行路由设置测试确保通过

## 7. 服务器启动和关闭实现（TDD）
- [ ] 7.1 编写服务器启动测试用例
  - [ ] 7.1.1 测试正常启动流程
  - [ ] 7.1.2 测试启动失败场景（端口占用）
  - [ ] 7.1.3 测试启动日志记录
- [ ] 7.2 编写服务器关闭测试用例
  - [ ] 7.2.1 测试优雅关闭流程
  - [ ] 7.2.2 测试关闭超时处理
  - [ ] 7.2.3 测试现有请求完成等待
- [ ] 7.3 实现 Start() 方法
- [ ] 7.4 实现 Stop() 方法
- [ ] 7.5 运行启停测试确保通过

## 8. 集成测试
- [ ] 8.1 编写端到端集成测试
  - [ ] 8.1.1 测试完整的服务器生命周期
  - [ ] 8.1.2 测试并发请求处理
  - [ ] 8.1.3 测试各种配置组合
- [ ] 8.2 编写性能基准测试
  - [ ] 8.2.1 测试请求处理延迟
  - [ ] 8.2.2 测试并发处理能力
- [ ] 8.3 运行集成测试确保整体功能正确

## 9. 文档和示例
- [ ] 9.1 编写模块使用示例代码
- [ ] 9.2 编写接口文档注释
- [ ] 9.3 创建配置示例和说明

## 10. 验证和清理
- [ ] 10.1 运行完整测试套件确保 100% 覆盖率
- [ ] 10.2 执行静态代码分析（make lint）
- [ ] 10.3 验证代码格式化（make fmt）
- [ ] 10.4 检查依赖安全性
- [ ] 10.5 更新项目文档（如果需要）

## 注意事项
- **TDD 原则**：每个功能实现前必须先编写测试用例
- **测试隔离**：使用 mock 隔离外部依赖
- **边界测试**：包含正常、异常、边界值测试场景
- **并发安全**：确保多 goroutine 环境下的正确性
- **错误处理**：所有错误场景都要有对应的测试和处理
- **日志验证**：关键操作都要有适当的日志记录验证
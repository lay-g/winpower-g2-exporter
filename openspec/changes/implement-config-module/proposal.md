# implement-config-module 变更提案

## Why

目前 WinPower G2 Exporter 项目缺少统一的配置管理模块，各模块无法通过标准化的方式加载和管理配置。这导致配置管理分散，缺乏统一的验证机制，也无法支持多源配置（文件、环境变量、命令行参数）的优先级合并。

实现统一的配置管理模块是项目的基础设施需求，将为后续的所有模块提供标准化的配置支持，提高代码的可维护性和用户体验。

## 参考资料

- [配置模块设计文档](../../../docs/design/config.md) - 详细的配置模块设计规范
- [项目上下文](../../project.md) - 项目整体约定和架构模式
- [现有模块规范](../../specs/) - 其他模块的配置需求参考

## What

### 新增功能
1. **统一配置管理器**：实现 ConfigManager 接口，提供类型安全的配置访问
2. **多源配置加载**：支持配置文件、环境变量、命令行参数的优先级合并
3. **多层级文件搜索**：按优先级自动搜索配置文件位置
4. **配置验证框架**：提供可扩展的配置验证接口
5. **默认值管理**：为所有配置项提供合理的默认值

### 技术实现
- 基于 viper 和 pflag 实现
- 支持YAML格式配置文件
- 环境变量使用 `WINPOWER_EXPORTER_` 前缀
- 配置键名支持点号分隔的层级结构
- 各模块配置结构体实现 ConfigValidator 接口

## Impact

- 新增 `internal/config` 包
- 为其他模块提供配置管理能力
- 暂不涉及 `cmd` 模块集成（后续单独实现）

## Success Criteria

1. 所有单元测试通过（覆盖率 > 80%）
2. 集成测试验证完整配置加载流程
3. 静态检查通过 (`make lint`)
4. 配置验证机制正常工作
5. 支持所有设计文档中定义的配置选项

## Implementation

详见 [tasks.md](./tasks.md) 和 [design.md](./design.md)。